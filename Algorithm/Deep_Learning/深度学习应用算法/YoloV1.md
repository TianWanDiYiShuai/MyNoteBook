# YoloV1

&emsp;&emsp;Yolo算法采用一个单独的CNN模型实现end-to-end的目标检测，整个系统如下图所示：首先将输入图片resize到448x448，然后送入CNN网络，最后处理网络预测结果得到检测的目标。相比R-CNN算法，其是一个统一的框架，其速度更快，而且Yolo的训练过程也是end-to-end的

![](/Image/算法/深度学习/深度学习应用算法/yolo1检测系统.jpg)

YoloV1将对象检测重新设计为单一回归问题，回归预测图像像素、边界框坐标、类概率。

## 1、思路流程

- 我们的系统将输入图像分为S*S的网格。如果对象的中心落入网格单元格中，则该网格单元格负责检测该对象。

![](/Image/算法/深度学习/深度学习应用算法/yolo1网格.jpg)

- 每个网格单元预测B个边界框的信息和置信度分数，共包含5个数据：

  - x：物体中心x的位置 (相对于网格边缘的坐标位置)

  - y：物体中心y的位置 (相对于网格边缘的坐标位置)

  - w：物体水平长度（相对于原始图片的预测位置）

  - h：物品垂直长度（相对于原始图片的预测位置）

  - conf：物品置信度，即有多大的概率这个框包含了物体，定义
    $$
    conf =P(object) \times IOU_{pred}^{truth}
    $$
    ，即该指标同时考虑物品的存在可能性和对应Bounding boxes与真实物体重叠的面积。如果该单元中不存在对象，则置信度分数应为零。否则置信度等于预测框与真实框之间的联合（IOU）交点。

- 每个网格单元还预测C个类别的可能概率，Pr(classi|Object)。这些概率取决于包含对象的网格单元。我们只预测每个网格单元的一组类别概率，而不管预测框的数量是多少。

- 在算法测试阶段，使用网格的类别概率乘以单个预测框的置信度来对每个预测框的特定类别的置信度评分。
  $$
  Pr(Class_i|Obiect)*Pr(Object)*IOUtruthpred=Pr(Class_i)*IOUtruthpred(1)
  $$
  系统将检测模型化为回归问题。它将图像划分为S*S的网格，并且每个网格单元预测B个边界框，对这些框的置信度以及C类概率。这些预测被编码为
  $$
  S\times S\times（B*5 +C）
  $$
  张量。

  ![](/Image/算法/深度学习/深度学习应用算法/yolo1算法流程.jpg)

## 2、网络设计

![](/Image/算法/深度学习/深度学习应用算法/yolo1网络结构.jpg)

检测网络有24个卷积层，其次是2个完全连接的层。交替的1*1卷积层减少了前一层的特征空间。在分辨率的一半（224*224输入图像）上对ImageNet分类任务的卷积层进行预处理，然后将分辨率加倍以进行检测。

## 3、网络训练

